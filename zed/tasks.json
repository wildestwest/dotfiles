// Project tasks configuration. See https://zed.dev/docs/tasks for documentation.
[
  {
    "label": "lazygit",
    "command": "lazygit",
    "hide": "on_success",
    "use_new_terminal": true,
    "reveal_target": "center",
    "allow_concurrent_runs": false,
    "shell": {
      "with_arguments": {
        "program": "zsh",
        "args": ["-f"]
      }
    }
  },
  {
    "label": "kube",
    "command": "k9s",
    "hide": "on_success",
    "use_new_terminal": true,
    "reveal_target": "center",
    "allow_concurrent_runs": false,
    "shell": {
      "with_arguments": {
        "program": "zsh",
        "args": ["-f"]
      }
    }
  },
  {
    "label": "pytest",
    "command": "source .venv/bin/activate && python -m pytest",
    "hide": "on_success",
    "reveal": "no_focus",
    "use_new_terminal": true,
    "allow_concurrent_runs": false,
    "shell": {
      "with_arguments": {
        "program": "zsh",
        "args": ["-f"]
      }
    }
  },
  {
    "label": "venv",
    "command": "rm -rf .venv && python3 -m venv .venv && source .venv/bin/activate && pip install -r requirements.txt -r requirements-testing.txt",
    "reveal": "no_focus",
    "hide": "on_success",
    "use_new_terminal": true,
    "allow_concurrent_runs": false,
    "shell": {
      "with_arguments": {
        "program": "zsh",
        "args": ["-f"]
      }
    }
  },
  {
    "label": "deploy",
    "command": "helm upgrade -i wes$(basename \"$ZED_WORKTREE_ROOT\" | sed 's/[-_]/ /g' | awk '{for(i=1;i<=NF;i++) printf substr($i,1,1)}') helm-charts/$(basename \"$ZED_WORKTREE_ROOT\" | tr '_' '-') -f intvalues.yaml --set image.tag=$(git rev-parse --abbrev-ref HEAD | tr '/' '_')",
    "cwd": "$ZED_WORKTREE_ROOT",
    "reveal": "no_focus",
    "hide": "on_success",
    "use_new_terminal": true,
    "allow_concurrent_runs": false,
    "shell": {
      "with_arguments": {
        "program": "zsh",
        "args": ["-f"]
      }
    }
  }
]
